package views

import "webpolls/services"
import "fmt"

templ Polls(polls []*services.PollResponse) {
		<h1 class="h1UnderHeader">Gestion de Encuestas</h1>
		<div class="gridLayout">
		    @PollForm()
            <div class="pollsSection">
                <h2>Lista de Encuestas</h2>
                @PollList(polls)
            </div>
		</div>

}

templ PollForm() {
	<div class="createPollDiv">
		<h2>Crear Encuesta</h2>
		<form hx-post="/polls/create" hx-on:reset-form="this.reset()" hx-target="#polls-list" hx-swap="outerHTML">
			@FormField("text", "question", "question", "¿Cual es tu deporte favorito?", "Pregunta")
			@FormField("number", "user-id", "user-id", "Id del usuario", "Id del usuario")
			<div id="optsContainer">
				for i := 1; i <= 4; i++ {
					@FormField("text", "options", fmt.Sprintf("option%d", i), fmt.Sprintf("Opción %d", i), fmt.Sprintf("Opción %d", i))
				}
			</div>
			<button type="submit">Crear Encuesta</button>
		</form>
	</div>
}

templ PollList(polls []*services.PollResponse) {

	<div id="polls-list" class="pollsContainer">
	    if len(polls) == 0{
                <p>No hay Encuestas</p>
            }
		for _, poll := range polls {
			@PollCard(poll)
		}
	</div>
}

templ PollCard(poll *services.PollResponse) {
	<div class="singlePollDiv">
		<h3>{ poll.Title }</h3>
		<ul>
			for _, option := range poll.Options {
				<li>{ option.Content }</li>
			}
		</ul>
		<button class="deleteBtn" hx-delete={ fmt.Sprintf("/polls/%d", poll.ID) } hx-target="#polls-list" hx-swap="outerHTML">
			Eliminar
		</button>
	</div>
}
